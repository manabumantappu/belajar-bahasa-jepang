<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Admin Chat â€“ Manabu Mantappu</title>

<link rel="stylesheet" href="chat.css">
</head>

<body>

<h2 style="text-align:center;margin:16px 0;">ğŸ§‘â€ğŸ’¼ Admin Live Chat</h2>

<div id="chat-box" style="display:flex;position:relative;width:90%;max-width:900px;margin:0 auto;height:80vh;">
  <div id="messages"></div>

  <input type="text" id="msg" placeholder="Balas sebagai admin..." />
  <button onclick="sendMessage()">Kirim</button>
</div>

<script type="module">
import { initializeApp } from 
"https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";

import { 
  getDatabase, 
  ref, 
  push, 
  onChildAdded, 
  query 
} from 
"https://www.gstatic.com/firebasejs/9.23.0/firebase-database.js";

const firebaseConfig = {
  apiKey: "AIzaSyBLBKQumtxegU4-oAX294e-WI3V57Dg",
  authDomain: "manabu-mantappu-chat.firebaseapp.com",
  databaseURL: "https://manabu-mantappu-chat-default-rtdb.asia-southeast1.firebasedatabase.app",
  projectId: "manabu-mantappu-chat",
  storageBucket: "manabu-mantappu-chat.appspot.com",
  messagingSenderId: "123456789012",
  appId: "1:123456789012:web:abcdef123456"
};

const app = initializeApp(firebaseConfig);
const db = getDatabase(app);
const messagesEl = document.getElementById("messages");

/* ğŸ§‘â€ğŸ’¼ ADMIN KIRIM */
window.sendMessage = () => {
  const msg = document.getElementById("msg").value.trim();
  if (!msg) return;

  push(ref(db,"chat"),{
    text: msg,
    time: Date.now(),
    role: "admin"
  });

  document.getElementById("msg").value="";
};

/* ğŸ“© TERIMA PESAN */
onChildAdded(query(ref(db,"chat")), (snap)=>{
  const data = snap.val();
  const div = document.createElement("div");

  div.className = data.role === "admin"
    ? "msg-admin"
    : "msg-user";

  div.innerText = data.text;
  messagesEl.appendChild(div);
  messagesEl.scrollTop = messagesEl.scrollHeight;
});
</script>

</body>
</html>
